# SmartAdminå‰åç«¯åä½œè§„èŒƒ

> **ä½œè€…**: wangxiao
> **ä¼ä¸š**: å­åˆçº¿é«˜ç§‘æ™ºèƒ½ç§‘æŠ€
> **æ›´æ–°æ—¶é—´**: 2025-10-04

---

## ğŸ“‹ ç›®å½•

1. [æ¥å£è§„èŒƒ](#æ¥å£è§„èŒƒ)
2. [æ•°æ®äº¤äº’è§„èŒƒ](#æ•°æ®äº¤äº’è§„èŒƒ)
3. [é”™è¯¯å¤„ç†åä½œ](#é”™è¯¯å¤„ç†åä½œ)
4. [å¼€å‘åä½œæµç¨‹](#å¼€å‘åä½œæµç¨‹)
5. [è”è°ƒè§„èŒƒ](#è”è°ƒè§„èŒƒ)

---

## æ¥å£è§„èŒƒ

### APIè·¯å¾„å‘½å

**å‰åç«¯ç»Ÿä¸€è§„èŒƒ**:

```
æ ¼å¼: /[åˆ†ç±»]/[æ¨¡å—]/[æ“ä½œ]

åˆ†ç±»: business | system | support
æ“ä½œ: add | update | delete | query | queryPage | detail
```

**ç¤ºä¾‹**:

| åŠŸèƒ½ | å‰ç«¯APIè·¯å¾„ | åç«¯Controllerè·¯å¾„ |
|------|-----------|------------------|
| ä¼ä¸šåˆ†é¡µæŸ¥è¯¢ | `/business/oa/enterprise/queryPage` | `@PostMapping("/oa/enterprise/page/query")` |
| æ–°å¢ä¼ä¸š | `/business/oa/enterprise/add` | `@PostMapping("/oa/enterprise/add")` |
| æ›´æ–°ä¼ä¸š | `/business/oa/enterprise/update` | `@PostMapping("/oa/enterprise/update")` |

### è¯·æ±‚æ–¹æ³•çº¦å®š

| æ“ä½œç±»å‹ | HTTPæ–¹æ³• | è¯´æ˜ |
|---------|---------|------|
| æŸ¥è¯¢åˆ—è¡¨ | POST | æ”¯æŒå¤æ‚æŸ¥è¯¢æ¡ä»¶ |
| æŸ¥è¯¢è¯¦æƒ… | GET | RESTfulé£æ ¼,ä½¿ç”¨è·¯å¾„å‚æ•° |
| æ–°å¢ | POST | è¯·æ±‚ä½“ä¼ é€’æ•°æ® |
| æ›´æ–° | POST | è¯·æ±‚ä½“ä¼ é€’æ•°æ® |
| åˆ é™¤ | GET | RESTfulé£æ ¼,ä½¿ç”¨è·¯å¾„å‚æ•° |

---

## æ•°æ®äº¤äº’è§„èŒƒ

### ç»Ÿä¸€å“åº”ç»“æ„

**åç«¯å®šä¹‰** (Java):

```java
public class ResponseDTO<T> {
    private Integer code;      // å“åº”ç 
    private String msg;        // å“åº”æ¶ˆæ¯
    private Boolean ok;        // æ˜¯å¦æˆåŠŸ
    private T data;           // å“åº”æ•°æ®
}
```

**å‰ç«¯å®šä¹‰** (TypeScript):

```typescript
export interface ResponseModel<T = any> {
  code: number;
  msg: string;
  ok: boolean;
  data: T;
}
```

### æ•°æ®å¯¹è±¡æ˜ å°„

| åç«¯ | å‰ç«¯ | ç”¨é€” |
|------|------|------|
| `QueryForm` | `QueryForm` | æŸ¥è¯¢æ¡ä»¶ |
| `AddForm` | `AddForm` | æ–°å¢è¡¨å• |
| `UpdateForm` | `UpdateForm` | æ›´æ–°è¡¨å• |
| `VO` | `VO` | è§†å›¾å¯¹è±¡(å“åº”æ•°æ®) |

**ç¤ºä¾‹æ˜ å°„**:

**åç«¯** `EnterpriseQueryForm.java`:
```java
public class EnterpriseQueryForm extends PageParam {
    @Schema(description = "ä¼ä¸šåç§°")
    private String enterpriseName;
}
```

**å‰ç«¯** `enterprise-model.ts`:
```typescript
export interface EnterpriseQueryForm extends PageParam {
  enterpriseName?: string; // ä¼ä¸šåç§°
}
```

### åˆ†é¡µå‚æ•°

**åç«¯** (Java):
```java
public class PageParam {
    private Integer pageNum = 1;   // é¡µç 
    private Integer pageSize = 10; // æ¯é¡µæ•°é‡
}

public class PageResult<T> {
    private Long total;           // æ€»è®°å½•æ•°
    private List<T> list;        // æ•°æ®åˆ—è¡¨
}
```

**å‰ç«¯** (TypeScript):
```typescript
export interface PageParam {
  pageNum: number;   // é¡µç ,ä»1å¼€å§‹
  pageSize: number;  // æ¯é¡µæ•°é‡
}

export interface PageResultModel<T> {
  total: number;     // æ€»è®°å½•æ•°
  list: T[];        // æ•°æ®åˆ—è¡¨
}
```

---

## é”™è¯¯å¤„ç†åä½œ

### é”™è¯¯ç ä½“ç³»

**åç«¯å®šä¹‰é”™è¯¯ç èŒƒå›´**:

| é”™è¯¯ç±»å‹ | é”™è¯¯ç èŒƒå›´ | å‰ç«¯å¤„ç†æ–¹å¼ |
|---------|----------|------------|
| UserErrorCode | 30001-30999 | æç¤ºç”¨æˆ·,å…è®¸é‡è¯• |
| SystemErrorCode | 10001-10999 | ç³»ç»Ÿé”™è¯¯æç¤º,è”ç³»ç®¡ç†å‘˜ |
| BusinessErrorCode | 50001-59999 | ä¸šåŠ¡è§„åˆ™æç¤º |

### å‰ç«¯é”™è¯¯å¤„ç†æµç¨‹

```typescript
// 1. åç«¯è¿”å›é”™è¯¯
const response = await enterpriseApi.add(form);

// 2. å‰ç«¯ç»Ÿä¸€æ‹¦æˆªå¤„ç†
if (!response.ok) {
  // æ ¹æ®é”™è¯¯ç èŒƒå›´åˆ¤æ–­
  if (response.code >= 30001 && response.code <= 30999) {
    // ç”¨æˆ·é”™è¯¯: ç›´æ¥æç¤º
    message.error(response.msg);
  } else if (response.code >= 10001 && response.code <= 10999) {
    // ç³»ç»Ÿé”™è¯¯: é€šç”¨æç¤º
    message.error('ç³»ç»Ÿå¼‚å¸¸,è¯·è”ç³»ç®¡ç†å‘˜');
  } else {
    // ä¸šåŠ¡é”™è¯¯: ç›´æ¥æç¤º
    message.error(response.msg);
  }
  return;
}

// 3. æˆåŠŸå¤„ç†
message.success('æ“ä½œæˆåŠŸ');
```

### åç«¯é”™è¯¯è¿”å›ç¤ºä¾‹

```java
// ä¸šåŠ¡é”™è¯¯
if (enterprise == null) {
    return ResponseDTO.error(BusinessErrorCode.ENTERPRISE_NOT_EXIST);
}

// å¯¹åº”å‰ç«¯æ¥æ”¶
{
  "code": 50001,
  "msg": "ä¼ä¸šä¸å­˜åœ¨",
  "ok": false,
  "data": null
}
```

---

## å¼€å‘åä½œæµç¨‹

### æ–°åŠŸèƒ½å¼€å‘æµç¨‹

```
1. éœ€æ±‚è¯„å®¡
   â”œâ”€ å‰åç«¯å…±åŒå‚ä¸
   â”œâ”€ ç¡®å®šæ¥å£å®šä¹‰
   â””â”€ ç¡®å®šæ•°æ®ç»“æ„

2. æ¥å£è®¾è®¡
   â”œâ”€ åç«¯: å®šä¹‰APIè·¯å¾„ã€è¯·æ±‚å‚æ•°ã€å“åº”ç»“æ„
   â””â”€ å‰ç«¯: ç¡®è®¤APIå®šä¹‰,åˆ›å»ºModelå’ŒAPIæ–‡ä»¶

3. å¹¶è¡Œå¼€å‘
   â”œâ”€ åç«¯: å®ç°Controller/Service/Dao
   â””â”€ å‰ç«¯: å®ç°é¡µé¢/ç»„ä»¶/APIè°ƒç”¨

4. è”è°ƒæµ‹è¯•
   â”œâ”€ åç«¯: æä¾›Swaggeræ–‡æ¡£
   â”œâ”€ å‰ç«¯: ä½¿ç”¨Postman/SwaggeréªŒè¯æ¥å£
   â””â”€ è”è°ƒ: å‰åç«¯é›†æˆæµ‹è¯•

5. ä»£ç å®¡æŸ¥
   â”œâ”€ åç«¯: æ£€æŸ¥ResponseDTOã€ErrorCodeã€æ³¨è§£
   â””â”€ å‰ç«¯: æ£€æŸ¥Modelå®šä¹‰ã€APIè°ƒç”¨ã€é”™è¯¯å¤„ç†
```

### æ¥å£å˜æ›´æµç¨‹

```
1. å‘èµ·å˜æ›´
   â””â”€ åç«¯: æå‰é€šçŸ¥å‰ç«¯æ¥å£å˜æ›´

2. æ›´æ–°æ–‡æ¡£
   â”œâ”€ åç«¯: æ›´æ–°Swaggeræ³¨è§£
   â””â”€ å‰ç«¯: æ›´æ–°Modelå®šä¹‰

3. ç‰ˆæœ¬æ§åˆ¶
   â”œâ”€ é‡å¤§å˜æ›´: æ–°å¢ç‰ˆæœ¬å·(/v2/...)
   â””â”€ å…¼å®¹å˜æ›´: ä¿æŒåŸæ¥å£,æ–°å¢å­—æ®µ

4. è”è°ƒéªŒè¯
   â””â”€ å‰åç«¯å…±åŒéªŒè¯å˜æ›´å½±å“
```

---

## è”è°ƒè§„èŒƒ

### ç¯å¢ƒé…ç½®

**åç«¯ç¯å¢ƒ**:
```yaml
# application-dev.yaml
server:
  port: 1024

# CORSé…ç½®
cors:
  allowed-origins: http://localhost:9527
```

**å‰ç«¯ç¯å¢ƒ**:
```typescript
// .env.development
VITE_API_BASE_URL=http://localhost:1024
```

### Swaggeræ–‡æ¡£

**åç«¯æä¾›**:
- Swagger UIåœ°å€: `http://localhost:1024/swagger-ui/index.html`
- OpenAPI JSON: `http://localhost:1024/v3/api-docs`

**å‰ç«¯ä½¿ç”¨**:
1. è®¿é—®Swagger UIæŸ¥çœ‹æ¥å£æ–‡æ¡£
2. ä½¿ç”¨"Try it out"æµ‹è¯•æ¥å£
3. ç¡®è®¤è¯·æ±‚å‚æ•°å’Œå“åº”ç»“æ„

### è”è°ƒæ£€æŸ¥æ¸…å•

#### åç«¯æ£€æŸ¥

- [ ] Controllerè·¯å¾„æ­£ç¡®
- [ ] @Operationæ³¨è§£åŒ…å«@author
- [ ] @SaCheckPermissionæƒé™ç æ­£ç¡®
- [ ] è¿”å›ResponseDTO<T>
- [ ] ErrorCodeå®šä¹‰å®Œæ•´
- [ ] Swaggeræ–‡æ¡£å¯è®¿é—®

#### å‰ç«¯æ£€æŸ¥

- [ ] APIè·¯å¾„ä¸åç«¯ä¸€è‡´
- [ ] Modelå®šä¹‰ä¸åç«¯VO/Formä¸€è‡´
- [ ] åˆ†é¡µå‚æ•°æ­£ç¡®(pageNumä»1å¼€å§‹)
- [ ] é”™è¯¯å¤„ç†å®Œæ•´
- [ ] æƒé™æ§åˆ¶(v-if="$privilege('code')")

### å¸¸è§é—®é¢˜

#### 1. è·¨åŸŸé—®é¢˜

**é—®é¢˜**: å‰ç«¯è°ƒç”¨åç«¯æ¥å£æŠ¥CORSé”™è¯¯

**è§£å†³**:
- åç«¯æ£€æŸ¥CORSé…ç½®
- ç¡®è®¤`allowed-origins`åŒ…å«å‰ç«¯åœ°å€

#### 2. åˆ†é¡µå‚æ•°ä¸ä¸€è‡´

**é—®é¢˜**: å‰ç«¯ä¼ pageNum=0,åç«¯æœŸæœ›ä»1å¼€å§‹

**è§£å†³**:
- ç»Ÿä¸€çº¦å®š: pageNumä»1å¼€å§‹
- å‰ç«¯ä½¿ç”¨PageParamåŸºç±»
- åç«¯ä½¿ç”¨SmartPageUtilå¤„ç†

#### 3. æšä¸¾å€¼ä¸åŒ¹é…

**é—®é¢˜**: å‰ç«¯ä¼ å­—ç¬¦ä¸²,åç«¯æœŸæœ›æ•°å­—

**è§£å†³**:
- åç«¯ä½¿ç”¨SmartEnumå®šä¹‰
- å‰ç«¯ä½¿ç”¨SmartEnumå¯¹åº”çš„TypeScriptå®šä¹‰
- ä¼ é€’valueå€¼,ä¸ä¼ desc

#### 4. æ—¥æœŸæ ¼å¼é—®é¢˜

**é—®é¢˜**: å‰ç«¯ä¼ "2025-10-04",åç«¯è§£æå¤±è´¥

**è§£å†³**:
- ç»Ÿä¸€ä½¿ç”¨ISO 8601æ ¼å¼: `2025-10-04T10:30:00`
- åç«¯ä½¿ç”¨LocalDateTime
- å‰ç«¯ä½¿ç”¨dayjså¤„ç†

---

## æœ€ä½³å®è·µ

### DO/DON'Tæ¸…å•

#### âœ… DO (åº”è¯¥è¿™æ ·åš)

**åç«¯**:
- æ‰€æœ‰æ¥å£è¿”å›ResponseDTO<T>
- ä½¿ç”¨ErrorCodeæšä¸¾ç®¡ç†é”™è¯¯
- Swaggeræ³¨è§£å®Œæ•´
- @authoræ ‡è¯†å®Œæ•´

**å‰ç«¯**:
- APIè·¯å¾„ä¸åç«¯ä¸€è‡´
- Modelå®šä¹‰ä¸åç«¯åŒæ­¥
- ç»Ÿä¸€é”™è¯¯å¤„ç†
- ä½¿ç”¨TypeScriptç±»å‹çº¦æŸ

#### âŒ DON'T (ä¸åº”è¯¥è¿™æ ·åš)

**åç«¯**:
- ç›´æ¥è¿”å›Entity
- ç¡¬ç¼–ç é”™è¯¯ä¿¡æ¯
- ç¼ºå°‘Swaggeræ–‡æ¡£
- éšæ„æ›´æ”¹æ¥å£

**å‰ç«¯**:
- ä½¿ç”¨anyç±»å‹
- ç¼ºå°‘é”™è¯¯å¤„ç†
- ç›´æ¥ç¡¬ç¼–ç æ¥å£è·¯å¾„
- å¿½ç•¥åˆ†é¡µå‚æ•°

---

## æ²Ÿé€šåä½œ

### æ—¥å¸¸æ²Ÿé€š

- **æ¥å£å˜æ›´**: æå‰1å¤©é€šçŸ¥
- **æ•°æ®ç»“æ„å˜æ›´**: æå‰2å¤©é€šçŸ¥
- **é‡å¤§é‡æ„**: æå‰1å‘¨è¯„å®¡

### é—®é¢˜åé¦ˆ

- **å‰ç«¯å‘ç°åç«¯é—®é¢˜**: æä¾›è¯·æ±‚å‚æ•°ã€å“åº”ç»“æœã€é”™è¯¯æˆªå›¾
- **åç«¯å‘ç°å‰ç«¯é—®é¢˜**: æä¾›æ¥å£è°ƒç”¨æ—¥å¿—ã€å‚æ•°æ ¡éªŒç»“æœ

### æ–‡æ¡£ç»´æŠ¤

- **åç«¯**: ä¿æŒSwaggeræ–‡æ¡£ä¸ä»£ç åŒæ­¥
- **å‰ç«¯**: ä¿æŒModelå®šä¹‰ä¸åç«¯VO/FormåŒæ­¥
- **å…±åŒ**: æ›´æ–°COLLABORATION_STANDARDS.md

---

**æŒç»­æ”¹è¿›**: æœ¬æ–‡æ¡£ä¼šéšé¡¹ç›®å‘å±•æŒç»­æ›´æ–°,æ¬¢è¿æå‡ºæ”¹è¿›å»ºè®®!
